- Container_Toggle:
    Control: GroupContainer@1.3.0
    Variant: ManualLayout
    Properties:
      DropShadow: =DropShadow.Regular
      Fill: =RGBA(245, 245, 245, 1)
      Height: =40
      RadiusBottomLeft: =20
      RadiusBottomRight: =20
      RadiusTopLeft: =20
      RadiusTopRight: =20
      Width: =ButtonCanvas_Option1.X + ButtonCanvas_Option2.X + ButtonCanvas_Option1.Width
      X: =40
      Y: =40
    Children:
      - Timer_UnderlyingColorAnimation:
          Control: Timer@2.1.0
          Properties:
            Duration: =250
            OnTimerEnd: =Set(gv_toggle_animating, false)
            Start: =gv_toggle_animating
            Visible: =false
      - HtmlText_UnderlyingColor:
          Control: HtmlViewer@2.1.0
          Properties:
            Color: =Color.WhiteSmoke
            Height: =ButtonCanvas_Option1.Height + 1
            HtmlText: |-
              =With(
                  {
                      r: Parent.RadiusTopLeft,
                      c1: "#0d47a1",
                      c2: "#42a5f5",
                      angle: 135
                  },
                  "
                  <div 
                      style='
                          width:" & Self.Width & "px; 
                          height:" & Self.Height - 1 & "px; 
                          margin:0; 
                          padding:0; 
                          box-sizing:border-box; 
                          border-radius:" & r & "px; 
                          background:linear-gradient(" & angle & "deg, " & c1 & " 0%, " & c2 & " 100%); 
                          display:block; 
                          overflow:hidden;
                      '
                  >
                  &nbsp;
                  </div>
                  "
              )
            OnSelect: |-
              =UpdateContext(
                  {
                      cv_toggle_selection: If(
                          cv_toggle_selection = 1, 
                          2, 
                          1
                      )
                  }
              );
              Reset(Timer_UnderlyingColorAnimation);
              Set(gv_toggle_animating, true)
            PaddingBottom: =0
            PaddingLeft: =0
            PaddingRight: =0
            PaddingTop: =0
            Width: |-
              =If(
                  gv_toggle_animating,
                  // During animation: interpolate between widths
                  If(
                      cv_toggle_selection = 1,
                      // Moving to Option 1
                      ButtonCanvas_Option2.Width - (ButtonCanvas_Option2.Width - ButtonCanvas_Option1.Width) * (Timer_UnderlyingColorAnimation.Value / Timer_UnderlyingColorAnimation.Duration),
                      // Moving to Option 2
                      ButtonCanvas_Option1.Width + (ButtonCanvas_Option2.Width - ButtonCanvas_Option1.Width) * (Timer_UnderlyingColorAnimation.Value / Timer_UnderlyingColorAnimation.Duration)
                  ),
                  // When not animating: snap to target width
                  If(
                      cv_toggle_selection = 1,
                      ButtonCanvas_Option1.Width,
                      ButtonCanvas_Option2.Width
                  )
              )
            X: |-
              =With(
                  {
                      startX: If(cv_toggle_selection = 1, ButtonCanvas_Option2.X, ButtonCanvas_Option1.X),
                      endX: If(cv_toggle_selection = 1, ButtonCanvas_Option1.X, ButtonCanvas_Option2.X),
                      t: Timer_UnderlyingColorAnimation.Value / Timer_UnderlyingColorAnimation.Duration
                  },
                  If(
                      gv_toggle_animating,
                      startX + (endX - startX) * If(t < 0.5, 2 * t * t, 1 - Power(-2 * t + 2, 2) / 2),
                      If(cv_toggle_selection = 1, ButtonCanvas_Option1.X, ButtonCanvas_Option2.X)
                  )
              )
            Y: =ButtonCanvas_Option1.Y
      - ButtonCanvas_Option1:
          Control: Button@0.0.45
          Properties:
            Appearance: ='ButtonCanvas.Appearance'.Transparent
            BorderRadius: =Parent.RadiusTopLeft
            FontColor: =If(Or(cv_toggle_selection = 1, IsBlank(cv_toggle_selection)), Color.WhiteSmoke, Color.Black)
            Height: =Parent.Height - 2*Self.Y
            OnSelect: |
              =If(
                  cv_toggle_selection = 1,
                  false,
                  UpdateContext({cv_toggle_selection: 1});
                  Reset(Timer_UnderlyingColorAnimation);
                  Set(gv_toggle_animating, true)
              )
            Text: ="Option 1"
            X: =4
            Y: =Self.X
      - ButtonCanvas_Option2:
          Control: Button@0.0.45
          Properties:
            Appearance: ='ButtonCanvas.Appearance'.Transparent
            BorderRadius: =Parent.RadiusTopLeft
            FontColor: =If(Or(cv_toggle_selection = 2, IsBlank(cv_toggle_selection)), Color.WhiteSmoke, Color.Black)
            Height: =ButtonCanvas_Option1.Height
            OnSelect: |-
              =If(
                  cv_toggle_selection = 2,
                  false,
                  UpdateContext({cv_toggle_selection: 2});
                  Reset(Timer_UnderlyingColorAnimation);
                  Set(gv_toggle_animating, true)
              )
            Text: ="Option 2"
            X: =ButtonCanvas_Option1.X + ButtonCanvas_Option1.Width + ButtonCanvas_Option1.X
            Y: =ButtonCanvas_Option1.Y
