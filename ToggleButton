Screens:
  Screen1:
    Children:
      - Container_Toggle:
          Control: GroupContainer@1.3.0
          Variant: ManualLayout
          Properties:
            Fill: =RGBA(235, 235, 235, 1)
            Height: =40
            RadiusBottomLeft: =20
            RadiusBottomRight: =20
            RadiusTopLeft: =20
            RadiusTopRight: =20
            Width: =ButtonCanvas_Option1.X + ButtonCanvas_Option2.X + ButtonCanvas_Option1.Width
            X: =40
            Y: =40
          Children:
            - ButtonCanvas_Option1:
                Control: Button@0.0.45
                Properties:
                  Appearance: ='ButtonCanvas.Appearance'.Transparent
                  BorderRadius: =Parent.RadiusTopLeft
                  FontColor: =If(Or(cv_toggle_selection = 1, IsBlank(cv_toggle_selection)), Color.WhiteSmoke, Color.Black)
                  Height: =Parent.Height - 2*Self.Y
                  OnSelect: |
                    =UpdateContext({cv_toggle_selection: 1});
                    Set(gv_toggle_animating, true);
                  Text: ="Option 1"
                  Visible: =cv_toggle_selection = 2
                  X: =4
                  Y: =Self.X
            - ButtonCanvas_Option2:
                Control: Button@0.0.45
                Properties:
                  Appearance: ='ButtonCanvas.Appearance'.Transparent
                  BorderRadius: =Parent.RadiusTopLeft
                  FontColor: =If(Or(cv_toggle_selection = 1, IsBlank(cv_toggle_selection)), Color.WhiteSmoke, Color.Black)
                  Height: =ButtonCanvas_Option1.Height
                  OnSelect: |-
                    =UpdateContext({cv_toggle_selection: 2});
                    Set(gv_toggle_animating, true);
                  Text: ="Option 2"
                  Visible: =cv_toggle_selection <> 2
                  X: =ButtonCanvas_Option1.X + ButtonCanvas_Option1.Width + ButtonCanvas_Option1.X
                  Y: =ButtonCanvas_Option1.Y
            - HtmlText_UnderlyingColor:
                Control: HtmlViewer@2.1.0
                Properties:
                  Color: =Color.WhiteSmoke
                  Height: =ButtonCanvas_Option1.Height + 1
                  HtmlText: |-
                    =With(
                        {
                            r: Parent.RadiusTopLeft,
                            c1: "#0d47a1",
                            c2: "#42a5f5",
                            angle: 135
                        },
                        "
                        <div 
                            style='
                                width:" & Self.Width & "px; 
                                height:" & Self.Height - 1 & "px; 
                                margin:0; 
                                padding:0; 
                                box-sizing:border-box; 
                                border-radius:" & r & "px; 
                                background:linear-gradient(" & angle & "deg, " & c1 & " 0%, " & c2 & " 100%); 
                                display:block; 
                                overflow:hidden;
                            '
                        >
                        " & If(
                            cv_toggle_selection = 1, ButtonCanvas_Option1.Text, ButtonCanvas_Option2.Text
                        ) & "
                        </div>
                        "
                    )
                  OnSelect: |
                    =UpdateContext(
                        {
                            cv_toggle_selection: If(
                                cv_toggle_selection = 1, 
                                2, 
                                1
                            )
                        }
                    );
                    Set(gv_toggle_animating, true);
                  PaddingBottom: =0
                  PaddingLeft: =0
                  PaddingRight: =0
                  PaddingTop: =0
                  Width: |-
                    =If(
                        gv_toggle_animating,
                        // During animation: interpolate between widths
                        If(
                            cv_toggle_selection = 1,
                            // Moving to Option 1
                            ButtonCanvas_Option2.Width - (ButtonCanvas_Option2.Width - ButtonCanvas_Option1.Width) * (Timer_UnderlyingColorAnimation.Value / Timer_UnderlyingColorAnimation.Duration),
                            // Moving to Option 2
                            ButtonCanvas_Option1.Width + (ButtonCanvas_Option2.Width - ButtonCanvas_Option1.Width) * (Timer_UnderlyingColorAnimation.Value / Timer_UnderlyingColorAnimation.Duration)
                        ),
                        // When not animating: snap to target width
                        If(
                            cv_toggle_selection = 1,
                            ButtonCanvas_Option1.Width,
                            ButtonCanvas_Option2.Width
                        )
                    )
                  X: |-
                    =With(
                        {
                            startX: If(cv_toggle_selection = 1, ButtonCanvas_Option2.X, ButtonCanvas_Option1.X),
                            endX: If(cv_toggle_selection = 1, ButtonCanvas_Option1.X, ButtonCanvas_Option2.X),
                            t: Timer_UnderlyingColorAnimation.Value / Timer_UnderlyingColorAnimation.Duration
                        },
                        If(
                            gv_toggle_animating,
                            startX + (endX - startX) * If(t < 0.5, 2 * t * t, 1 - Power(-2 * t + 2, 2) / 2),
                            If(cv_toggle_selection = 1, ButtonCanvas_Option1.X, ButtonCanvas_Option2.X)
                        )
                    )
                  Y: =ButtonCanvas_Option1.Y
      - Timer_UnderlyingColorAnimation:
          Control: Timer@2.1.0
          Properties:
            Duration: =500
            OnTimerEnd: =Set(gv_toggle_animating, false)
            Start: =gv_toggle_animating
            X: =705
            Y: =80
      - ButtonCanvas2:
          Control: Button@0.0.45
          Properties:
            Appearance: ='ButtonCanvas.Appearance'.Transparent
            OnSelect: |-
              =UpdateContext({cv_toggle_selection: 1});
              Set(gv_toggle_animating, false);
            X: =1245
            Y: =20
